(this["webpackJsonpcompare-archives"]=this["webpackJsonpcompare-archives"]||[]).push([[0],{100:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(17),i=n.n(r),s=(n(60),n(15)),o=n(9),u=n(27),l=n.n(u),h=(n(73),n(12)),f=n.n(h),g=n(21);function j(){return(j=Object(g.a)(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/es-title-pk-suggest/?q=".concat(t),e.next=3,fetch(n,{credentials:"include"});case 3:return a=e.sent,e.next=6,a.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return b.apply(this,arguments)}function b(){return(b=Object(g.a)(f.a.mark((function e(t){var n,a,c,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={archives:t},a=l.a.stringify(n,{indices:!1}),c="/api/?".concat(a),e.next=5,fetch(c,{credentials:"include"});case 5:return r=e.sent,e.next=8,r.json();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=Object(g.a)(f.a.mark((function e(t,n){var a,c,r,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={algos:t,pk:n},c=l.a.stringify(a,{indices:!1}),r="/compare-archives/?".concat(c),e.next=5,fetch(r,{credentials:"include"});case 5:return i=e.sent,e.next=8,i.json();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e,t,n){return m.apply(this,arguments)}function m(){return(m=Object(g.a)(f.a.mark((function e(t,n,a){var c,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="/live-image-thumbnail/".concat(t,"/").concat(n,"/?base64=1&full=").concat(a?"1":""),e.next=3,fetch(c,{credentials:"include"});case 3:return r=e.sent,e.next=6,r.text();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=n(102),y=n(103),x=n(104),k=n(105),M=n(7),w=n.n(M),N=n(53),S=n.n(N);n(76);function C(e){var t=Math.log(e)/Math.log(1024)|0,n=(e/Math.pow(1024,t)).toFixed(2);return"".concat(n," ").concat(0===t?"bytes":"".concat("KMGTPEZY"[t-1],"B"))}var E=["language","artist","group","parody","character","female","male","mixed","other","misc"];function A(e){var t=[];E.forEach((function(n){var a=e.filter((function(e){return e.startsWith("".concat(n,":"))})).map((function(e){return e.replace("".concat(n,":"),"")})).sort();a.length>0&&t.push([n,a])}));var n=e.filter((function(e){return!E.find((function(t){return e.startsWith("".concat(t,":"))}))})).sort();return n.length>0&&t.push(["",n]),t}var F=n(41),L=n(101),I=n(4);var P=function(e){var t=e.imageRenderer,n=e.buttonContent,a=c.a.useState(!1),r=Object(o.a)(a,2),i=r[0],s=r[1],u=c.a.useState(!1),l=Object(o.a)(u,2),h=l[0],f=l[1],g=c.a.useState(),j=Object(o.a)(g,2),d=j[0],b=j[1];return c.a.useEffect((function(){i&&!d&&(f(!0),t().then((function(e){b(e),f(!1)})))}),[d,t,i]),Object(I.jsx)(F.Popover,{isOpen:i,padding:5,positions:["right","left","bottom","top"],content:function(e){var t=e.position,n=e.childRect,a=e.popoverRect;return Object(I.jsx)(F.ArrowContainer,{position:t,childRect:n,popoverRect:a,arrowColor:"green",arrowSize:10,arrowStyle:{opacity:1},className:"popover-arrow-container",arrowClassName:"popover-arrow",children:!h&&d?d:Object(I.jsx)(L.a,{color:"primary"})})},children:Object(I.jsx)("button",{type:"button",className:"btn btn-primary btn-sm",onClick:function(){return s(!i)},children:n})})},J=function(e,t){return(null===t||void 0===t?void 0:t.current)?"current-highlight":(null===t||void 0===t?void 0:t.highlight)?"hash-highlight":e&&e.other.length>0?"hash-match":""},R=function(e){return e?S.a.unix(e).format("MM-DD-YYYY"):"No"};function D(e){var t=e.data,n=e.archives,a=e.loading,r=e.showMatchesOnly,i=e.showNonMatchesOnly,s=e.fetchFull,u=c.a.useState(new Map),l=Object(o.a)(u,2),h=l[0],j=l[1],d=c.a.useState(new Map),b=Object(o.a)(d,2),p=b[0],m=b[1],M=c.a.useState(new Map),N=Object(o.a)(M,2),S=N[0],E=N[1],F=c.a.useCallback((function(){var e=new Map,n=new Map;Object.keys(t).forEach((function(a){return Object.keys(t[a].images).forEach((function(c){var r={matchedImages:0};Object.keys(t[a].images[c]).forEach((function(n){var i=[];if(Object.keys(t[a].images).filter((function(e){return e!==c})).forEach((function(e){Object.keys(t[a].images[e]).filter((function(r){return t[a].images[e][r]===t[a].images[c][n]})).forEach((function(t){return i.push({algorithm:a,archive:e,image:t})}))})),i.length>0){var s=JSON.stringify({algorithm:a,archive:c,image:n});e.set(s,{other:i})}r.matchedImages+=i.length}));var i=JSON.stringify({algorithm:a,archive:c});n.set(i,r)}))})),m(e),E(n)}),[t]),L=c.a.useCallback((function(){var e=new Map;Object.keys(t).forEach((function(n){return Object.keys(t[n].images).forEach((function(a){return Object.keys(t[n].images[a]).forEach((function(t){var c=JSON.stringify({algorithm:n,archive:a,image:t});e.set(c,{current:!1,highlight:!1})}))}))})),j(e)}),[t]);c.a.useEffect((function(){F()}),[F,t]),c.a.useEffect((function(){L()}),[L,t]);var D=function(e,t){var n=p.get(e),a=h.get(e);void 0===a?h.set(e,{current:t,highlight:!1}):(a.highlight=!1,a.current=t,h.set(e,a)),n&&n.other.forEach((function(e){var n=JSON.stringify(e),a=h.get(n);void 0===a?h.set(n,{current:!1,highlight:t}):(a.highlight=t,a.current=!1,h.set(n,a))})),j(new Map(h))},Y=function(e){return e?e.other.map((function(e){return Object(I.jsx)("span",{className:"mr-1",children:"A: ".concat(e.archive,", I: ").concat(e.image)},"".concat(e.archive,"-").concat(e.image))})):[]},z=function(e){var t=S.get(e);return t?t.matchedImages:0},_=function(){var e=Object(g.a)(f.a.mark((function e(t,n,a){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(t,n,a);case 2:return c=e.sent,e.abrupt("return",Object(I.jsx)("img",{alt:n,src:"".concat(c)}));case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}();return Object(I.jsx)(I.Fragment,{children:a?Object(I.jsx)("div",{className:"text-center",children:"Loading results, might take a while depending on algorithm..."}):Object(I.jsxs)(v.a,{bordered:!0,size:"sm",className:"results-table",children:[Object(I.jsxs)("thead",{children:[Object(I.jsx)("tr",{children:Object.keys(t).map((function(e){return Object(I.jsx)("th",{className:"text-center",colSpan:Object.keys(t[e].images).length,children:e},e)}))}),Object(I.jsx)("tr",{children:Object.keys(t).map((function(e){return Object.keys(t[e].images).map((function(t){var a=n.find((function(e){return e.id.toString()===t}));return a?Object(I.jsx)("th",{className:"mid-content",children:Object(I.jsxs)(y.a,{children:[Object(I.jsx)(y.a,{left:!0,className:"mr-2",children:a.thumbnail?Object(I.jsx)("img",{src:a.thumbnail,alt:a.title}):null}),Object(I.jsxs)(y.a,{body:!0,children:[Object(I.jsx)(y.a,{heading:!0,children:a.title}),Object(I.jsxs)("div",{children:["Link: ",Object(I.jsx)("a",{href:a.url,children:"/archive/".concat(t,"/")})," | ","Images: ".concat(a.filecount)," | ","Size: ".concat(C(a.filesize))," | ","Matches: ".concat(z(JSON.stringify({algorithm:e,archive:t})))]}),Object(I.jsxs)("div",{children:["Added: ".concat(R(a.create_date?a.create_date:a.public_date))," | ","Posted: ".concat(R(a.posted))," | ","Public: ".concat(R(a.public_date))]}),Object(I.jsx)("div",{children:A(a.tags).map((function(e){return Object(I.jsx)("div",{children:Object(I.jsx)(x.a,{children:Object(I.jsxs)(k.a,{children:[e[0]?Object(I.jsx)("div",{className:"mr-1",children:e[0]+":"}):"",e[1].map((function(e){return Object(I.jsx)("div",{className:"tag-element mr-1",children:e},e)}))]})})},e[0])}))})]})]})},t):null}))}))})]}),Object(I.jsx)("tbody",{children:Object(I.jsx)("tr",{children:Object.keys(t).map((function(e){return Object.keys(t[e].images).map((function(n){return Object(I.jsx)("td",{className:"shaCell",children:Object(I.jsx)("ul",{className:"list-group",children:Object.keys(t[e].images[n]).map((function(a){var c=JSON.stringify({algorithm:e,archive:n,image:a}),o=p.get(c);return r&&!(o&&o.other.length>0)||i&&void 0!==o&&0!==o.other.length?null:Object(I.jsxs)("li",{className:w()("list-group-item",J(o,h.get(c))),onMouseEnter:function(){return D(c,!0)},onMouseLeave:function(){return D(c,!1)},children:[Object(I.jsx)(P,{buttonContent:a,imageRenderer:function(){return _(n,a,s)}}),": ",Object(I.jsx)("span",{children:t[e].images[n][a]}),o&&o.other.length>0?Object(I.jsxs)("span",{children:[" > "," ",Y(o)]}):""]},a)})).filter((function(e){return null!=e}))})},n)}))}))})})]})})}var Y=n(54),z={menu:function(e,t){return Object(s.a)(Object(s.a)({},e),{},{color:t.selectProps.menuColor})}};var _=function(e){var t=e.algorithms,n=e.availableAlgorithms,a=e.selectOption,c=e.isLoading;return Object(I.jsx)(Y.a,{value:t.map((function(e){return{value:e,label:e}})),isClearable:!0,isDisabled:c,isMulti:!0,onChange:function(e){a(e.map((function(e){return e.value})))},options:n.map((function(e){return{value:e,label:e}})),noOptionsMessage:function(){return null},placeholder:"Choose Algorithms...",menuColor:"black",styles:z})},B=n(55),T=(n(99),{menu:function(e,t){return Object(s.a)(Object(s.a)({},e),{},{color:t.selectProps.menuColor})}});var V=function(e){var t=e.archives,n=e.isLoading,c=e.selectOption,r=Object(a.useState)(""),i=Object(o.a)(r,2)[1],s=Object(a.useState)(!1),u=Object(o.a)(s,2),l=u[0],h=u[1];return Object(I.jsx)(B.a,{isLoading:l||n,isDisabled:l||n,value:t,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,getOptionLabel:function(e){return"".concat(e.id,": ").concat(e.title)},getOptionValue:function(e){return e.id},loadOptions:function(e){h(!0);var t=function(e){return j.apply(this,arguments)}(e);return h(!1),t},onInputChange:function(e){i(e)},onChange:function(e){c(e.map((function(e){return e})))},noOptionsMessage:function(){return null},placeholder:"Choose Archives...",menuColor:"black",styles:T})},W=n(106),q=n(107),G=n(108);var K=function(){var e=c.a.useState({}),t=Object(o.a)(e,2),n=t[0],a=t[1],r=c.a.useState([]),i=Object(o.a)(r,2),u=i[0],h=i[1],f=c.a.useState([]),g=Object(o.a)(f,2),j=g[0],b=g[1],O=c.a.useState([]),m=Object(o.a)(O,2),v=m[0],y=m[1],x=c.a.useState({MatchesOnly:!1,NonMatchesOnly:!1}),k=Object(o.a)(x,2),M=k[0],w=k[1],N=c.a.useState(!1),S=Object(o.a)(N,2),C=S[0],E=S[1],A=c.a.useState(!1),F=Object(o.a)(A,2),L=F[0],P=F[1],J=c.a.useState(""),R=Object(o.a)(J,2),Y=R[0],z=R[1],B=c.a.useCallback((function(e){var t=e.algos,n=e.pk;t.length<1||n.length<1?a({}):(P(!0),function(e,t){return p.apply(this,arguments)}(t,n).then((function(e){a(e.results),P(!1),z("")})).catch((function(e){P(!1),z(e.message)})))}),[]);c.a.useEffect((function(){!function(){var e,t,n=l.a.parse(window.location.search,{ignoreQueryPrefix:!0});e=void 0!==n.algos?Array.isArray(n.algos)?n.algos.map((function(e){return e.toString()})):"string"===typeof n.algos?[n.algos]:["sha1"]:["sha1"],h(e),t=void 0!==n.archives?Array.isArray(n.archives)?n.archives.map((function(e){return e.toString()})):"string"===typeof n.archives?[n.archives]:[]:[];var a={MatchesOnly:!1,NonMatchesOnly:!1};void 0!==n.matchesOnly&&(a.MatchesOnly=!0),void 0!==n.nonMatchesOnly&&(a.NonMatchesOnly=!0),w(a),void 0!==n.fetchFull&&E(!0),e.length<1||t.length<1||(P(!0),d(t).then((function(e){b(e),y(e),P(!1),z("")})).catch((function(e){P(!1),z(e.message)})))}()}),[]),c.a.useEffect((function(){B({algos:u,pk:j.map((function(e){return e.id}))})}),[u,j,B]);var T=c.a.useCallback((function(e){e.length<1?y([]):(P(!0),d(e).then((function(e){y(e),P(!1),z("")})).catch((function(e){P(!1),z(e.message)})))}),[]);return Object(I.jsx)("main",{className:"App",children:Object(I.jsxs)("div",{children:[Object(I.jsx)(V,{archives:j,selectOption:function(e){b(e),T(e.map((function(e){return e.id})))},isLoading:L}),Object(I.jsx)(_,{algorithms:u,selectOption:function(e){h(e)},availableAlgorithms:["sha1","phash","ahash","dhash","whash-haar","whash-db4","colorhash"],isLoading:L}),Y?Object(I.jsx)("div",{className:"text-center",children:Y}):null,Object(I.jsxs)(W.a,{children:[Object(I.jsx)(q.a,{children:"Options"}),Object(I.jsxs)("div",{children:[Object(I.jsx)(G.a,{type:"switch",label:"Show Matches Only",checked:M.MatchesOnly,onChange:function(e){M.MatchesOnly=e.target.checked,e.target.checked&&(M.NonMatchesOnly=!e.target.checked),w(Object(s.a)({},M))},id:"matchesOnly",inline:!0}),Object(I.jsx)(G.a,{type:"switch",label:"Show Non-Matches Only",checked:M.NonMatchesOnly,onChange:function(e){e.target.checked&&(M.MatchesOnly=!e.target.checked),M.NonMatchesOnly=e.target.checked,w(Object(s.a)({},M))},id:"nonMatchesOnly",inline:!0}),Object(I.jsx)(G.a,{type:"switch",label:"Fetch Full Images",checked:C,onChange:function(e){E(e.target.checked)},id:"fetchFull",inline:!0})]})]}),Object(I.jsx)(D,{data:n,archives:v,loading:L,showMatchesOnly:M.MatchesOnly,showNonMatchesOnly:M.NonMatchesOnly,fetchFull:C})]})})},Q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,109)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};i.a.render(Object(I.jsx)(c.a.StrictMode,{children:Object(I.jsx)(K,{})}),document.getElementById("root")),Q()},60:function(e,t,n){},71:function(e,t){},73:function(e,t,n){},76:function(e,t,n){},99:function(e,t,n){}},[[100,1,2]]]);
//# sourceMappingURL=main.46a9b69f.chunk.js.map